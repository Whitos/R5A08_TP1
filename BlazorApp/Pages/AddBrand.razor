@page "/add-brand"

@inject IBrandService BrandService
@inject NavigationManager Nav

<h3 class="mb-4 fw-bold">Nouvelle Marque</h3>

<EditForm Model="brand" OnValidSubmit="HandleSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="card shadow-sm border-0 mb-3">
        <div class="card-body">
            <div class="mb-3">
                <label class="form-label fw-semibold">Nom de la marque</label>
                <InputText class="form-control" @bind-Value="brand.NameBrand" />
            </div>
        </div>
    </div>

    <div class="d-flex gap-2">
        <button class="btn btn-primary" type="submit"><i class="bi bi-check2"></i> Enregistrer</button>
        <button class="btn btn-secondary" type="button" @onclick="GoBack"><i class="bi bi-x"></i> Annuler</button>
    </div>
</EditForm>

@code {
    private BrandCreateDto brand = new();
    private bool isSubmitting;

    private async Task HandleSubmit()
    {
        if (isSubmitting) return;
        isSubmitting = true;
        try
        {
            await BrandService.AddAsync(brand);
            Nav.NavigateTo("/products");
        }
        finally
        {
            isSubmitting = false;
        }
    }

    private void GoBack() => Nav.NavigateTo("/products");
}

<style>
    form .card { border-radius: 12px; }
</style>
